# entry point for training and inference